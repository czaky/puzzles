"""Test module for puzzles solved using branch and bound."""

import unittest

import branch_and_bound as bnb
import grid


class TestBranchAndBound(unittest.TestCase):
    """Test class for branch and bound puzzles."""

    def test_tsp(self):
        """Test `tsp`."""
        assert bnb.tsp([[0]]) == 0
        assert bnb.tsp([[0, 111], [112, 0]]) == 223
        assert bnb.tsp([[0, 111, 555], [112, 0, 555], [113, 222, 0]]) == 779
        assert bnb.tsp([[0, 1000, 5000], [5000, 0, 1000], [1000, 5000, 0]]) == 3000
        g = grid.parse(
            """\
            0 2 7 7
            1 0 9 9
            1 8 0 9
            5 2 10 0"""
        )
        assert bnb.tsp(g) == 19

        g = grid.parse(
            """\
            0 4430 6977 2797 9384 5713 7860 8499
            8061 0 8306 7416 545 3111 3344 6000
            1891 7812 0 5617 9606 8926 790 1251
            961 6814 6060 0 6914 4297 3065 6399
            8986 9587 1126 1090 0 5199 594 9271
            5846 15 8138 4425 7613 0 4242 3207
            4997 5408 5716 5024 1763 7331 0 5057
            4229 2391 6263 7616 8667 2987 1953 0"""
        )
        assert bnb.tsp(g) == 16588

        g = grid.parse(
            """\
            0 2167 3150 2813 8453 9303 8998 1918
            5018 0 4676 8015 1595 6768 6350 5244
            7573 9787 0 3790 547 7036 9899 8995
            1117 5451 7862 0 4295 8814 5240 1755
            3228 9558 8463 711 0 8959 5713 8069
            9601 8133 3995 1343 3068 0 347 6450
            7294 6795 164 2589 4651 5219 0 9887
            6554 4997 2876 7940 2550 7778 1101 0"""
        )
        assert bnb.tsp(g) == 16569
        g = grid.parse(
            """\
        107 816 247 307 92 417 423 55 365 876 435 456 299 101 577 324 10 335 978 130
        94 146 382 92 570 256 895 664 574 853 571 507 301 493 250 952 584 144 319 61
        365 916 585 259 660 605 759 975 189 698 449 670 264 140 359 372 281 698 157 772
        839 860 603 100 651 676 711 572 505 120 499 423 904 389 635 431 710 234 260 866
        93 254 382 986 18 840 676 346 94 706 457 937 305 325 798 299 738 84 810 996
        539 137 723 644 620 712 389 126 490 450 594 717 646 169 856 273 495 279 57 848
        909 307 516 917 945 78 559 882 704 155 670 715 117 335 777 971 385 367 974 325
        161 969 7 347 475 973 158 601 703 693 460 307 994 174 193 519 218 352 449 227
        962 602 600 942 197 912 690 224 578 266 888 145 366 564 876 978 920 356 219 577
        441 808 949 345 914 614 407 162 239 830 76 416 28 282 137 273 856 578 643 957
        394 794 246 421 237 23 522 68 457 105 684 572 603 4 722 129 587 663 84 667
        201 295 715 818 883 274 901 816 400 515 922 104 794 844 577 73 737 692 229 660
        361 454 720 921 3 142 61 151 297 304 791 283 291 820 158 74 504 799 125 551
        211 721 293 143 690 557 984 726 212 834 989 236 469 344 822 844 462 251 494 868
        874 204 899 266 188 63 899 941 841 968 320 104 206 68 494 918 811 983 529 767
        595 677 681 160 336 341 837 145 404 991 504 440 16 335 254 851 1000 491 769 98
        333 588 694 477 675 595 858 149 972 677 761 468 970 54 991 374 68 832 783 137
        197 225 379 451 654 298 138 809 133 854 105 732 614 864 525 55 39 144 431 504
        352 39 151 380 551 218 708 865 241 898 70 322 5 110 102 369 269 89 601 704
        115 519 166 58 81 231 71 129 612 143 228 540 697 590 968 624 435 772 215 556"""
        )
        assert bnb.tsp(g) == 1708
